{"programModules":{"EXT001MI":{"program":"EXT001MI","triggers":{},"transactions":{"GenPickingList":{"sourceUuid":"9fb0d7fe-0796-4803-9476-1366ccc20bc8","name":"GenPickingList","program":"EXT001MI","description":"GenPickingList","active":true,"multi":true,"modified":1723883226242,"modifiedBy":"INFNIXONG","outputFields":[{"name":"TEXT","description":"text","length":600,"mandatory":false,"type":"A"}],"inputFields":[{"name":"CONO","description":"company","length":3,"mandatory":false,"type":"N"},{"name":"DLIX","description":"delivery number","length":11,"mandatory":false,"type":"N"},{"name":"CONN","description":"shipment","length":7,"mandatory":false,"type":"N"}],"utilities":[],"market":"ALL"}},"batches":{},"advancedPrograms":{}}},"utilities":{},"sources":{"9fb0d7fe-0796-4803-9476-1366ccc20bc8":{"uuid":"9fb0d7fe-0796-4803-9476-1366ccc20bc8","updated":1725264627692,"updatedBy":"INFDANONG","created":1723624243400,"createdBy":"INFNIXONG","apiVersion":"0.21","beVersion":"16.0.0.20240621022400.6","language":"GROOVY","codeHash":"67471C0CCAE72E9123374EE1B14872A593C23DCCD84F88D2FA136C42A9D33CBB","code":"LyoqDQoqICBATmFtZTogRVhUMDAxTUkuR2VuUGlja2luZ0xpc3QNCiogIEBEZXNjcmlwdGlvbjogRXh0ZW5kT3V0cHV0IGZvciBNV1M0MzVQRg0KKiAgQEF1dGhvcnM6IE5peG9uIFBvd2VyIE9uZw0KKi8NCg0KLyoqDQoqIENIQU5HRUxPR1MNCiogVmVyc2lvbiAgICBEYXRlICAgIFVzZXIgICAgICAgICAgICAgICBEZXNjcmlwdGlvbg0KKiAxLjAuMCAgICAgIDI0MDMxNSAgTml4b24gUG93ZXIgT25nICAgIEluaXRpYWwgUmVsZWFzZQ0KKiAxLjAuMSAgICAgIDI0MDUwOCAgTml4b24gUG93ZXIgT25nICAgIEFmdGVyIFh0ZW5kTTMgcmV2aWV3DQoqIDEuMS4wICAgICAgMjQwNTIzICBOaXhvbiBQb3dlciBPbmcgICAgQWRkaXRpb25hbCBsb2dpYw0KKiAxLjEuMSAgICAgIDI0MDUyOCAgTml4b24gUG93ZXIgT25nICAgIENoYW5nZWQgc25ha2UgY2FzZSB2YXJpYWJsZSB0byBsb3dlciBjYW1lbCBjYXNlDQoqIDEuMS4yICAgICAgMjQwNjA2ICBOaXhvbiBQb3dlciBPbmcgICAgQWRkZWQgbG9naWMgZm9yIE0wMSBNTVM0ODBQRg0KKiAxLjEuMyAgICAgIDI0MDYwNyAgTml4b24gUG93ZXIgT25nICAgIENhc3QgSVROTyB0byBTdHJpbmcNCiogMS4xLjQgICAgICAyNDA2MjAgIE5peG9uIFBvd2VyIE9uZyAgICBDb3VudCBwYWdlIHBlciB0eXBlIDEsMiwzOyBBZGRlZCBQTFFUIE1NUzQ4MFBGDQoqIDEuMS41ICAgICAgMjQwNzA1ICBOaXhvbiBQb3dlciBPbmcgICAgQWRkZWQgbmV3IGZpZWxkcyBmb3IgTU1TNDgwUEYgRVhUNDgwIHRhYmxlDQoqIDEuMS42ICAgICAgMjQwNzExICBOaXhvbiBQb3dlciBPbmcgICAgQWRkZWQgU0VRTiBmb3IgRVhUNDgwDQoqIDEuMS43ICAgICAgMjQwNzIyICBOaXhvbiBQb3dlciBPbmcgICAgQWRkZWQgbG9naWMgZm9yIEFSUzE5OVBGdjENCiogMi4wLjAgICAgICAyNDA3MjkgIE5peG9uIFBvd2VyIE9uZyAgICBBZGRlZCBDT0FGIGZvciBFWFQ0MzQsNDM1LDQzNiBQaWNraW5nIExpc3QNCiogMi4wLjEgICAgICAyNDA3MjkgIE5peG9uIFBvd2VyIE9uZyAgICBSZW1vdmVkIEVYVERFTCB2YWxpZGF0aW9uLCBBZGRlZCBTQVBSIGZyb20gT1BSSUNMDQoqIDIuMC4yICAgICAgMjQwODAxICBOaXhvbiBQb3dlciBPbmcgICAgUmVmcmVzaCBFWFQ0NzksRVhUNDgwIHdoZW4gcHJpbnRpbmcgRE4gd2l0aCBkZWxldGVkIGxpbmUNCiogMi4wLjMgICAgICAyNDA4MjIgIE5peG9uIFBvd2VyIE9uZyAgICBST1JDICE9IDMgZ2V0IE1SVFdTTCBhcyBDT05BLCBtb3ZlZCBmcm9tIENSRVhQUlQgdG8gVHJhbnNhY3Rpb24NCiovDQoNCmltcG9ydCBqYXZhLnV0aWwuKjsNCmltcG9ydCBqYXZhLnV0aWwucmVnZXguKjsNCmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlOw0KaW1wb3J0IGphdmEudGltZS5Mb2NhbERhdGVUaW1lOw0KaW1wb3J0IGphdmEudGltZS5Mb2NhbFRpbWU7DQppbXBvcnQgamF2YS50aW1lLmZvcm1hdC5EYXRlVGltZUZvcm1hdHRlcjsNCmltcG9ydCBqYXZhLnRpbWUuZm9ybWF0LkRhdGVUaW1lUGFyc2VFeGNlcHRpb247DQoNCnB1YmxpYyBjbGFzcyBHZW5QaWNraW5nTGlzdCBleHRlbmRzIEV4dGVuZE0zVHJhbnNhY3Rpb24gew0KICBwcml2YXRlIGZpbmFsIE1JQVBJIG1pOw0KICBwcml2YXRlIGZpbmFsIFByb2dyYW1BUEkgcHJvZ3JhbTsNCiAgcHJpdmF0ZSBmaW5hbCBEYXRhYmFzZUFQSSBkYXRhYmFzZTsNCiAgcHJpdmF0ZSBmaW5hbCBMb2dnZXJBUEkgbG9nZ2VyOw0KICBwcml2YXRlIGZpbmFsIE1JQ2FsbGVyQVBJIG1pQ2FsbGVyOw0KICANCiAgcHJpdmF0ZSBmaW5hbCBpbnQgTUFYX1JFQ09SRFMgPSAxMDAwMDsNCiAgcHJpdmF0ZSBmaW5hbCBpbnQgcm93U2l6ZSA9IDE1Ow0KICANCiAgcHVibGljIEdlblBpY2tpbmdMaXN0KE1JQVBJIG1pLCBQcm9ncmFtQVBJIHByb2dyYW0sIERhdGFiYXNlQVBJIGRhdGFiYXNlLCBMb2dnZXJBUEkgbG9nZ2VyLCBNSUNhbGxlckFQSSBtaUNhbGxlcikgew0KICAgIHRoaXMubWkgPSBtaTsNCgkgIHRoaXMucHJvZ3JhbSA9IHByb2dyYW07DQogICAgdGhpcy5kYXRhYmFzZSA9IGRhdGFiYXNlOw0KICAgIHRoaXMubG9nZ2VyID0gbG9nZ2VyOw0KICAgIHRoaXMubWlDYWxsZXIgPSBtaUNhbGxlcjsNCiAgfQ0KICANCiAgcHVibGljIHZvaWQgbWFpbigpIHsNCiAgICBpbnQgQ09OTyA9IHByb2dyYW0uTERBWkQuZ2V0KCJDT05PIik7DQogICAgaW50IElOT1UgPSAxOw0KICAgIGludCBDT05OID0gbWkuaW4uZ2V0KCJDT05OIikgPT0gbnVsbCA/IDAgOiBtaS5pbi5nZXQoIkNPTk4iKSBhcyBpbnQ7DQogICAgbG9uZyBETElYID0gbWkuaW4uZ2V0KCJETElYIikgPT0gbnVsbCA/IDAgYXMgbG9uZyA6IG1pLmluLmdldCgiRExJWCIpIGFzIGxvbmc7DQogICAgDQogICAgREJBY3Rpb24gcXVlcnkgPSBkYXRhYmFzZS50YWJsZSgiTUhESVNIIikuaW5kZXgoIjAwIikuc2VsZWN0aW9uKCJPUUNPTk4iKS5idWlsZCgpOw0KICAgIERCQ29udGFpbmVyIGNvbnRhaW5lciA9IHF1ZXJ5LmNyZWF0ZUNvbnRhaW5lcigpOw0KICAgIGNvbnRhaW5lci5zZXQoIk9RQ09OTyIsIENPTk8pOw0KICAgIGNvbnRhaW5lci5zZXQoIk9RSU5PVSIsIElOT1UpOw0KICAgIGNvbnRhaW5lci5zZXQoIk9RRExJWCIsIERMSVgpOw0KICAgIA0KICAgIGlmKENPTk4gPT0gMCkgew0KICAgICAgaWYocXVlcnkucmVhZChjb250YWluZXIpKSB7DQogICAgICAgIENPTk4gPSBjb250YWluZXIuZ2V0KCJPUUNPTk4iKTsNCiAgICAgICAgDQogICAgICAgDQogICAgICB9IGVsc2Ugew0KICAgICAgICBtaS5lcnJvcigiU2hpcG1lbnQgY2Fubm90IGJlIGZvdW5kIik7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICB9DQogICAgDQogICAgcXVlcnkgPSBkYXRhYmFzZS50YWJsZSgiTUhESVNIIikuaW5kZXgoIjIwIikuc2VsZWN0aW9uKCJPUUNPTk8iLCAiT1FJTk9VIiwgIk9RQ09OTiIsICJPUURMSVgiLCAiT1FDT05BIiwgIk9RUEdSUyIsICJPUUNPQUYiLCAiT1FEU0RUIikuYnVpbGQoKTsNCiAgICBjb250YWluZXIgPSBxdWVyeS5jcmVhdGVDb250YWluZXIoKTsNCiAgICBjb250YWluZXIuc2V0KCJPUUNPTk8iLCBDT05PKTsNCiAgICBjb250YWluZXIuc2V0KCJPUUlOT1UiLCBJTk9VKTsNCiAgICBjb250YWluZXIuc2V0KCJPUUNPTk4iLCBDT05OKTsNCiAgICAgICANCiAgICBpbnQgaW5kZXggPSAzOw0KICAgIA0KICAgIGlmKENPTk4gPT0gMCkgew0KICAgICAgQ09OTiA9IERMSVggYXMgaW50Ow0KICAgICAgcXVlcnkgPSBkYXRhYmFzZS50YWJsZSgiTUhESVNIIikuaW5kZXgoIjAwIikuc2VsZWN0aW9uKCJPUUNPTk8iLCAiT1FJTk9VIiwgIk9RQ09OTiIsICJPUURMSVgiLCAiT1FDT05BIiwgIk9RUEdSUyIsICJPUUNPQUYiLCAiT1FEU0RUIikuYnVpbGQoKTsNCiAgICAgIGNvbnRhaW5lciA9IHF1ZXJ5LmNyZWF0ZUNvbnRhaW5lcigpOw0KICAgICAgY29udGFpbmVyLnNldCgiT1FDT05PIiwgQ09OTyk7DQogICAgICBjb250YWluZXIuc2V0KCJPUUlOT1UiLCBJTk9VKTsNCiAgICAgIGNvbnRhaW5lci5zZXQoIk9RRExJWCIsIERMSVgpOw0KICAgICAgICAgDQogICAgICBpbmRleCA9IDM7DQogICAgfQ0KICAgIA0KICAgIGRlbGV0ZVJlY29yZHNCeUNPTk4oQ09OTywgQ09OTiwgIkVYVDQzNCIpOw0KICAgIGRlbGV0ZVJlY29yZHNCeUNPTk4oQ09OTywgQ09OTiwgIkVYVDQzNSIpOw0KICAgIGRlbGV0ZVJlY29yZHNCeUNPTk4oQ09OTywgQ09OTiwgIkVYVDQzNiIpOw0KICAgIA0KICAgIGRlbGV0ZVJlY29yZHNCeURMSVgoQ09OTywgRExJWCwgIkVYVEQzNCIpOw0KICAgIGRlbGV0ZVJlY29yZHNCeURMSVgoQ09OTywgRExJWCwgIkVYVEQzNSIpOw0KICAgIGRlbGV0ZVJlY29yZHNCeURMSVgoQ09OTywgRExJWCwgIkVYVEQzNiIpOw0KICAgIA0KICAgIEFycmF5TGlzdDxNYXA8U3RyaW5nLCBTdHJpbmc+PiBsaW5lcyA9IG5ldyBBcnJheUxpc3Q8TWFwPFN0cmluZywgU3RyaW5nPj4oKTsNCiAgICBBcnJheUxpc3Q8TWFwPFN0cmluZywgU3RyaW5nPj4gZGVsaXZlcnlsaW5lcyA9IG5ldyBBcnJheUxpc3Q8TWFwPFN0cmluZywgU3RyaW5nPj4oKTsNCiAgICANCiAgICBEQkFjdGlvbiBxdWVyeU1IRElTTCA9IGRhdGFiYXNlLnRhYmxlKCJNSERJU0wiKS5pbmRleCgiMDAiKS5zZWxlY3Rpb24oIlVSQ09OTyIsICJVUkRMSVgiLCAiVVJJVE5PIiwgIlVSUklETiIsICJVUlJJREwiKS5idWlsZCgpOw0KICAgIERCQ29udGFpbmVyIGNvbnRhaW5lck1IRElTTCA9IHF1ZXJ5TUhESVNMLmNyZWF0ZUNvbnRhaW5lcigpOw0KICAgIA0KICAgIERCQWN0aW9uIHF1ZXJ5TUlUTUFIID0gZGF0YWJhc2UudGFibGUoIk1JVE1BSCIpLmluZGV4KCIwMCIpLnNlbGVjdGlvbigiSE1UWTE1IiwgIkhNVFgxNSIpLmJ1aWxkKCk7DQogICAgREJDb250YWluZXIgY29udGFpbmVyTUlUTUFIID0gcXVlcnlNSVRNQUguY3JlYXRlQ29udGFpbmVyKCk7DQogICAgDQogICAgcXVlcnkucmVhZEFsbChjb250YWluZXIsIGluZGV4LCBNQVhfUkVDT1JEUywgeyBEQkNvbnRhaW5lciBtaGRpc2hEYXRhIC0+DQogICAgICBNYXAgcmVzdWx0ID0gbmV3IEhhc2hNYXAoKTsgDQogICAgICANCiAgICAgIGxvbmcgbGluZURMSVggPSBtaGRpc2hEYXRhLmdldCgiT1FETElYIikgYXMgbG9uZzsNCiAgICAgIFN0cmluZyBDT05BID0gbWhkaXNoRGF0YS5nZXQoIk9RQ09OQSIpOw0KICAgICAgaW50IE9RUEdSUyA9ICBtaGRpc2hEYXRhLmdldCgiT1FQR1JTIikgYXMgaW50Ow0KICAgICAgU3RyaW5nIENPQUYgPSBtaGRpc2hEYXRhLmdldCgiT1FDT0FGIik7DQogICAgICBpbnQgRFNEVCA9IG1oZGlzaERhdGEuZ2V0KCJPUURTRFQiKTsNCiAgICAgIA0KICAgICAgbWkub3V0RGF0YS5wdXQoIlRFWFQiLCAiJHtDT05OfSAke2xpbmVETElYfSIpOw0KICAgICAgbWkud3JpdGUoKTsNCiAgICAgIA0KICAgICAgDQogICAgICBjb250YWluZXJNSERJU0wuc2V0KCJVUkNPTk8iLCBDT05PKTsNCiAgICAgIGNvbnRhaW5lck1IRElTTC5zZXQoIlVSRExJWCIsIGxpbmVETElYKTsNCiAgICAgIGludCBjdHIgPSAxOw0KICAgICAgaW50IHBhZ2VOdW0gPSAxOw0KICAgICAgDQogICAgICBxdWVyeU1IRElTTC5yZWFkQWxsKGNvbnRhaW5lck1IRElTTCwgMiwgTUFYX1JFQ09SRFMsIHsgREJDb250YWluZXIgbWhkaXNsRGF0YSAtPg0KICAgICAgICBpZihPUVBHUlMgPj0gNTApIHsNCiAgICAgICAgICBNYXAgcmVzdWx0TGluZSA9IG5ldyBIYXNoTWFwKCk7IA0KICAgICAgICAgIA0KICAgICAgICAgIC8vIENvbnZlcnRzIElUTk8gdG8gYSBzb3J0YWJsZSBpbnRlZ2VyIChleC4gMTAxMTIzNCAxIC0+IDEwMTEyMzQwMSwgMTAxMTIzNCAyMiAtPiAxMDExMjM0MjIpDQogICAgICAgICAgU3RyaW5nIElUTk8gPSBtaGRpc2xEYXRhLmdldCgiVVJJVE5PIik7DQogICAgICAgICAgU3RyaW5nIElUTiA9IElUTk8ucmVwbGFjZUFsbCgiXFxzKyIsICIgIik7DQogICAgICAgICAgU3RyaW5nW10gaXRub3MgPSBJVE4uc3BsaXQoIiAiKTsNCiAgICAgICAgICBTdHJpbmcgbnVtU3RyaW5nID0gIiI7DQogICAgICAgICAgU3RyaW5nIElUTjIgPSAiIjsNCiAgICAgICAgICBpZihpdG5vcy5sZW5ndGggPiAxKSB7DQogICAgICAgICAgICBpZihpdG5vc1sxXS5pc051bWJlcigpKXsNCiAgICAgICAgICAgICAgaW50IG51bSA9IGl0bm9zWzFdIGFzIGludDsNCiAgICAgICAgICAgICAgDQogICAgICAgICAgICAgIGlmKG51bSA8IDEwKSB7DQogICAgICAgICAgICAgICAgbnVtU3RyaW5nID0gIjAiICsgbnVtOw0KICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIG51bVN0cmluZyA9IG51bTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICBJVE4yID0gaXRub3NbMF0gKyBudW1TdHJpbmc7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICBJVE4yID0gSVROOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBJVE4yID0gSVROTzsNCiAgICAgICAgICB9DQogICAgICAgICAgDQogICAgICAgICAgZG91YmxlIFNBUFIgPSAwOw0KICAgICAgICAgIA0KICAgICAgICAgIEV4cHJlc3Npb25GYWN0b3J5IGV4cE9QUklDTCA9IGRhdGFiYXNlLmdldEV4cHJlc3Npb25GYWN0b3J5KCJPUFJJQ0wiKTsNCiAgICAgICAgICBleHBPUFJJQ0wgPSBleHBPUFJJQ0wuZXEoIk9NUFJSRiIsICJKTyIpLmFuZChleHBPUFJJQ0wuZXEoIk9NQ1VOTyIsICIiKS5hbmQoZXhwT1BSSUNMLmxlKCJPTUZWRFQiLCBEU0RUIGFzIFN0cmluZykuYW5kKGV4cE9QUklDTC5nZSgiT01MVkRUIiwgRFNEVCBhcyBTdHJpbmcpKSkpOw0KICAgICAgICAgIA0KICAgICAgICAgIERCQWN0aW9uIHF1ZXJ5T1BSSUNMID0gZGF0YWJhc2UudGFibGUoIk9QUklDTCIpLm1hdGNoaW5nKGV4cE9QUklDTCkuaW5kZXgoIjYwIikuc2VsZWN0aW9uKCJPTVNBUFIiKS5idWlsZCgpOw0KICAgICAgICAgIERCQ29udGFpbmVyIGNvbnRhaW5lck9QUklDTCA9IHF1ZXJ5T1BSSUNMLmNyZWF0ZUNvbnRhaW5lcigpOw0KICAgICAgICAgIGNvbnRhaW5lck9QUklDTC5zZXQoIk9NQ09OTyIsIENPTk8pOw0KICAgICAgICAgIGNvbnRhaW5lck9QUklDTC5zZXQoIk9NSVROTyIsIElUTk8pOw0KICAgICAgICAgIA0KICAgICAgICAgIHF1ZXJ5T1BSSUNMLnJlYWRBbGwoY29udGFpbmVyT1BSSUNMLCAyLCAxLCB7IERCQ29udGFpbmVyIGRhdGFPUFJJQ0wgLT4NCiAgICAgICAgICAgIFNBUFIgPSBkYXRhT1BSSUNMLmdldCgiT01TQVBSIik7DQogICAgICAgICAgfSk7DQogICAgICAgIA0KICAgICAgICAgIFN0cmluZyBibG9ja05vID0gZ2V0QmxvY2soQ09OTywgSVROTyk7DQogICAgICAgICAgU3RyaW5nIGNvbG9yID0gIiI7DQogICAgICAgICAgU3RyaW5nIHNpemUgPSAiIjsNCiAgICAgICAgICANCiAgICAgICAgICBjb250YWluZXJNSVRNQUguc2V0KCJITUNPTk8iLCBDT05PKTsNCiAgICAgICAgICBjb250YWluZXJNSVRNQUguc2V0KCJITUlUTk8iLCBJVE5PKTsNCiAgICAgICAgICANCiAgICAgICAgICBpZiAocXVlcnlNSVRNQUgucmVhZChjb250YWluZXJNSVRNQUgpKSB7DQogICAgICAgICAgICBjb2xvciA9IGNvbnRhaW5lck1JVE1BSC5nZXQoIkhNVFkxNSIpOw0KICAgICAgICAgICAgc2l6ZSA9IGNvbnRhaW5lck1JVE1BSC5nZXQoIkhNVFgxNSIpOw0KICAgICAgICAgIH0NCiAgICAgICAgICANCiAgICAgICAgICByZXN1bHRMaW5lLnB1dCgiRExJWCIsIGxpbmVETElYKTsNCiAgICAgICAgICByZXN1bHRMaW5lLnB1dCgiQ09OQSIsIENPTkEudHJpbSgpKTsNCiAgICAgICAgICByZXN1bHRMaW5lLnB1dCgiT1JOTyIsIG1oZGlzbERhdGEuZ2V0KCJVUlJJRE4iKSk7DQogICAgICAgICAgcmVzdWx0TGluZS5wdXQoIlBPTlIiLCBtaGRpc2xEYXRhLmdldCgiVVJSSURMIikgYXMgU3RyaW5nKTsNCiAgICAgICAgICByZXN1bHRMaW5lLnB1dCgiSVROTyIsIElUTk8gYXMgU3RyaW5nKTsNCiAgICAgICAgICByZXN1bHRMaW5lLnB1dCgiSVROMiIsIElUTjIgYXMgU3RyaW5nKTsNCiAgICAgICAgICByZXN1bHRMaW5lLnB1dCgiQ0ZJNCIsIGJsb2NrTm8pOw0KICAgICAgICAgIHJlc3VsdExpbmUucHV0KCJDT0xSIiwgY29sb3IpOw0KICAgICAgICAgIHJlc3VsdExpbmUucHV0KCJTSVpFIiwgc2l6ZSk7DQogICAgICAgICAgcmVzdWx0TGluZS5wdXQoIkNPQUYiLCBDT0FGLnRyaW0oKSk7DQogICAgICAgICAgcmVzdWx0TGluZS5wdXQoIlNBUFIiLCBTQVBSIGFzIFN0cmluZyk7DQogICAgICAgIA0KICAgICAgICAgIGlmKGJsb2NrTm8uaXNOdW1iZXIoKSkgew0KICAgICAgICAgICAgaW50IGJsb2NrID0gYmxvY2tObyBhcyBpbnQ7DQogICAgICAgICAgICANCiAgICAgICAgICAgIGlmKGJsb2NrIDw9IDM5OTkpIHsNCiAgICAgICAgICAgICAgcmVzdWx0TGluZS5wdXQoIlRZUEUiLCAiMSIpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgcmVzdWx0TGluZS5wdXQoIlRZUEUiLCAiMiIpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgIHJlc3VsdExpbmUucHV0KCJUWVBFIiwgIjEiKTsNCiAgICAgICAgICB9DQogICAgICAgIA0KICAgICAgICANCiAgICAgICAgICBsaW5lcy5hZGQocmVzdWx0TGluZSk7DQogICAgICAgICAgDQogICAgICAgICAgaWYoRExJWCA9PSBsaW5lRExJWCkgew0KICAgICAgICAgICAgZGVsaXZlcnlsaW5lcy5hZGQocmVzdWx0TGluZSk7DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9KTsNCiAgICANCiAgICBpbnNlcnREYXRhVG9FWFREMzYoQ09OTywgRExJWCwgZGVsaXZlcnlsaW5lcyk7ICANCiAgICBpbnNlcnREYXRhVG9FWFQ0MzYoQ09OTywgQ09OTiwgbGluZXMpOw0KICAgIA0KICAgIHByb2Nlc3NTb3J0ZWREYXRhU2luZ2xlKENPTk8sIERMSVgsIHJvd1NpemUpOw0KICAgIHByb2Nlc3NTb3J0ZWREYXRhQWxsKENPTk8sIENPTk4sIHJvd1NpemUpOw0KICAgDQogICAgY29tcHV0ZVRvdGFsUGFnZUVYVEQzNChDT05PLCBETElYKTsNCiAgICBjb21wdXRlVG90YWxQYWdlRVhUNDM0KENPTk8sIENPTk4pOw0KICB9DQogIA0KICAvKioNCiAgICogR2V0IHRvdGFsIG51bWJlciBvZiBwYWdlcyBmb3IgRVhUNDM0DQogICAqIEBwYXJhbXMgQ09OTyAtIElucHV0IENPTk8NCiAgICogQHBhcmFtcyBDT05OIC0gSW5wdXQgc2hpcG1lbnQgbnVtYmVyDQogICAqIEByZXR1cm4gbm90aGluZw0KICAqLw0KICB2b2lkIGNvbXB1dGVUb3RhbFBhZ2VFWFQ0MzQoaW50IENPTk8sIGludCBDT05OKSB7DQogICAgREJBY3Rpb24gcXVlcnkgPSBkYXRhYmFzZS50YWJsZSgiRVhUNDM0IikuaW5kZXgoIjAwIikuc2VsZWN0aW9uKCJFWENPTkEiLCAiRVhDT0FGIiwgIkVYVFlQRSIsICJFWFBBR0UiKS5idWlsZCgpOw0KICAgIERCQ29udGFpbmVyIGNvbnRhaW5lciA9IHF1ZXJ5LmNyZWF0ZUNvbnRhaW5lcigpOw0KICAgIGNvbnRhaW5lci5zZXQoIkVYQ09OTyIsIENPTk8pOw0KICAgIGNvbnRhaW5lci5zZXQoIkVYQ09OTiIsIENPTk4pOw0KICAgDQogICAgU3RyaW5nIGN1cnJDT05BID0gbnVsbDsNCiAgICBTdHJpbmcgY3VyckNPQUYgPSBudWxsOw0KICAgIGludCBjdHIgPSAwOw0KICAgDQogICAgcXVlcnkucmVhZEFsbChjb250YWluZXIsIDIsIE1BWF9SRUNPUkRTLCB7IERCQ29udGFpbmVyIGRhdGEgLT4NCiAgICAgIE1hcCByZXN1bHQgPSBuZXcgSGFzaE1hcCgpOyANCiAgICAgIA0KICAgICAgU3RyaW5nIENPTkEgPSBkYXRhLmdldCgiRVhDT05BIik7DQogICAgICBTdHJpbmcgQ09BRiA9IGRhdGEuZ2V0KCJFWENPQUYiKTsNCiAgICAgIA0KICAgICAgaWYoY3VyckNPTkEgPT0gbnVsbCAmJiBjdXJyQ09BRiA9PSBudWxsKSB7DQogICAgICAgIGN1cnJDT05BID0gQ09OQTsNCiAgICAgICAgY3VyckNPQUYgPSBDT0FGOw0KICAgICAgfQ0KICAgICAgDQogICAgICBpZighY3VyckNPTkEuZXF1YWxzKENPTkEpIHx8IChjdXJyQ09OQS5lcXVhbHMoQ09OQSkgJiYgIWN1cnJDT0FGLmVxdWFscyhDT0FGKSkpIHsNCiAgICAgICAgdXBkYXRlTWF4UGFnZUVYVDQzNChDT05PLCBDT05OLCBjdXJyQ09OQSwgY3VyckNPQUYsIGN0cik7DQogICAgICAgIGN0ciA9IDA7DQogICAgICAgIGN1cnJDT05BID0gQ09OQTsNCiAgICAgICAgY3VyckNPQUYgPSBDT0FGOw0KICAgICAgfSANCiAgICAgIA0KICAgICAgY3RyKys7DQogICAgfSk7DQogICAgDQogICAgdXBkYXRlTWF4UGFnZUVYVDQzNChDT05PLCBDT05OLCBjdXJyQ09OQSwgY3VyckNPQUYsIGN0cik7DQogIH0NCiAgDQogIC8qKg0KICAgKiBVcGRhdGUgTVhQRywgRFBHTiBpbiBFWFQ0MzQgVGFibGUNCiAgICogQHBhcmFtcyBDT05PIC0gSW5wdXQgQ09OTw0KICAgKiBAcGFyYW1zIENPTk4gLSBJbnB1dCBzaGlwbWVudCBudW1iZXINCiAgICogQHBhcmFtcyBDT05BIC0gSW5wdXQgY29uc2lnbmVlIG51bWJlcg0KICAgKiBAcGFyYW1zIHZhbCAtIElucHV0IHRvdGFsIHBhZ2VzDQogICAqIEByZXR1cm4gbm90aGluZw0KICAqLw0KICB2b2lkIHVwZGF0ZU1heFBhZ2VFWFQ0MzQoaW50IENPTk8sIGludCBDT05OLCBTdHJpbmcgQ09OQSwgU3RyaW5nIENPQUYsIGludCB2YWwpIHsNCiAgICBEQkFjdGlvbiBxdWVyeSA9IGRhdGFiYXNlLnRhYmxlKCJFWFQ0MzQiKS5pbmRleCgiMDAiKS5idWlsZCgpOw0KICAgIERCQ29udGFpbmVyIGNvbnRhaW5lciA9IHF1ZXJ5LmdldENvbnRhaW5lcigpOw0KICAgIGNvbnRhaW5lci5zZXQoIkVYQ09OTyIsIENPTk8pOw0KICAgIGNvbnRhaW5lci5zZXQoIkVYQ09OTiIsIENPTk4pOw0KICAgIGNvbnRhaW5lci5zZXQoIkVYQ09OQSIsIENPTkEpOw0KICAgIGNvbnRhaW5lci5zZXQoIkVYQ09BRiIsIENPQUYpOw0KICAgIA0KICAgIGludCBjdHIgPSAxOw0KICAgIA0KICAgIENsb3N1cmU8Pz4gdXBkYXRlQ2FsbEJhY2sgPSB7IExvY2tlZFJlc3VsdCBsb2NrZWRSZXN1bHQgLT4NCiAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYTVhQRyIsIHZhbCk7DQogICAgICBsb2NrZWRSZXN1bHQuc2V0KCJFWERQR04iLCBjdHIpOw0KICAgICAgbG9ja2VkUmVzdWx0LnNldCgiRVhDSE5PIiwgKGludClsb2NrZWRSZXN1bHQuZ2V0KCJFWENITk8iKSArIDEpOw0KICAgICAgbG9ja2VkUmVzdWx0LnNldCgiRVhMTURUIiwgTG9jYWxEYXRlLm5vdygpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oInl5eXlNTWRkIikpLnRvSW50ZWdlcigpKTsNCiAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYQ0hJRCIsIHByb2dyYW0uZ2V0VXNlcigpKTsNCiAgICAgIA0KICAgICAgbG9ja2VkUmVzdWx0LnVwZGF0ZSgpOw0KICAgICAgY3RyKys7DQogICAgfTsNCiAgICANCiAgICBxdWVyeS5yZWFkQWxsTG9jayhjb250YWluZXIsIDQsIHVwZGF0ZUNhbGxCYWNrKTsNCiAgfQ0KICANCiAgLyoqDQogICAqIEdldCB0b3RhbCBudW1iZXIgb2YgcGFnZXMgZm9yIEVYVDQzNA0KICAgKiBAcGFyYW1zIENPTk8gLSBJbnB1dCBDT05PDQogICAqIEBwYXJhbXMgQ09OTiAtIElucHV0IHNoaXBtZW50IG51bWJlcg0KICAgKiBAcmV0dXJuIG5vdGhpbmcNCiAgKi8NCiAgdm9pZCBjb21wdXRlVG90YWxQYWdlRVhURDM0KGludCBDT05PLCBsb25nIERMSVgpIHsNCiAgICBEQkFjdGlvbiBxdWVyeSA9IGRhdGFiYXNlLnRhYmxlKCJFWFREMzQiKS5pbmRleCgiMDAiKS5zZWxlY3Rpb24oIkVYQ09OQSIsICJFWENPQUYiLCAiRVhUWVBFIiwgIkVYUEFHRSIpLmJ1aWxkKCk7DQogICAgREJDb250YWluZXIgY29udGFpbmVyID0gcXVlcnkuY3JlYXRlQ29udGFpbmVyKCk7DQogICAgY29udGFpbmVyLnNldCgiRVhDT05PIiwgQ09OTyk7DQogICAgY29udGFpbmVyLnNldCgiRVhETElYIiwgRExJWCk7DQogICANCiAgICBTdHJpbmcgY3VyckNPTkEgPSBudWxsOw0KICAgIGludCBjdHIgPSAwOw0KICAgIFN0cmluZyBjdXJyQ09BRiA9IG51bGw7DQogICANCiAgICBxdWVyeS5yZWFkQWxsKGNvbnRhaW5lciwgMiwgTUFYX1JFQ09SRFMsIHsgREJDb250YWluZXIgZGF0YSAtPg0KICAgICAgTWFwIHJlc3VsdCA9IG5ldyBIYXNoTWFwKCk7IA0KICAgICAgDQogICAgICBTdHJpbmcgQ09OQSA9IGRhdGEuZ2V0KCJFWENPTkEiKTsNCiAgICAgIFN0cmluZyBDT0FGID0gZGF0YS5nZXQoIkVYQ09BRiIpOw0KICAgICAgDQogICAgICBpZihjdXJyQ09OQSA9PSBudWxsICYmIGN1cnJDT0FGID09IG51bGwpIHsNCiAgICAgICAgY3VyckNPTkEgPSBDT05BOw0KICAgICAgICBjdXJyQ09BRiA9IENPQUY7DQogICAgICB9DQogICAgICANCiAgICAgIGlmKCFjdXJyQ09OQS5lcXVhbHMoQ09OQSkgfHwgKGN1cnJDT05BLmVxdWFscyhDT05BKSAmJiAhY3VyckNPQUYuZXF1YWxzKENPQUYpKSkgew0KICAgICAgICB1cGRhdGVNYXhQYWdlRVhURDM0KENPTk8sIERMSVgsIGN1cnJDT05BLCBjdXJyQ09BRiwgY3RyKTsNCiAgICAgICAgY3RyID0gMDsNCiAgICAgICAgY3VyckNPTkEgPSBDT05BOw0KICAgICAgICBjdXJyQ09BRiA9IENPQUY7DQogICAgICB9DQogICAgICANCiAgICAgIGN0cisrOw0KICAgIH0pOw0KICAgIA0KICAgIHVwZGF0ZU1heFBhZ2VFWFREMzQoQ09OTywgRExJWCwgY3VyckNPTkEsIGN1cnJDT0FGLCBjdHIpOw0KICB9DQogIA0KICAvKioNCiAgICogVXBkYXRlIE1YUEcsIERQR04gaW4gRVhUNDM0IFRhYmxlDQogICAqIEBwYXJhbXMgQ09OTyAtIElucHV0IENPTk8NCiAgICogQHBhcmFtcyBDT05OIC0gSW5wdXQgc2hpcG1lbnQgbnVtYmVyDQogICAqIEBwYXJhbXMgQ09OQSAtIElucHV0IGNvbnNpZ25lZSBudW1iZXINCiAgICogQHBhcmFtcyB2YWwgLSBJbnB1dCB0b3RhbCBwYWdlcw0KICAgKiBAcmV0dXJuIG5vdGhpbmcNCiAgKi8NCiAgdm9pZCB1cGRhdGVNYXhQYWdlRVhURDM0KGludCBDT05PLCBsb25nIERMSVgsIFN0cmluZyBDT05BLCBTdHJpbmcgQ09BRiwgaW50IHZhbCkgew0KICAgIERCQWN0aW9uIHF1ZXJ5ID0gZGF0YWJhc2UudGFibGUoIkVYVEQzNCIpLmluZGV4KCIwMCIpLmJ1aWxkKCk7DQogICAgREJDb250YWluZXIgY29udGFpbmVyID0gcXVlcnkuZ2V0Q29udGFpbmVyKCk7DQogICAgY29udGFpbmVyLnNldCgiRVhDT05PIiwgQ09OTyk7DQogICAgY29udGFpbmVyLnNldCgiRVhETElYIiwgRExJWCk7DQogICAgY29udGFpbmVyLnNldCgiRVhDT05BIiwgQ09OQSk7DQogICAgY29udGFpbmVyLnNldCgiRVhDT0FGIiwgQ09BRik7DQogICAgDQogICAgaW50IGN0ciA9IDE7DQogICAgDQogICAgQ2xvc3VyZTw/PiB1cGRhdGVDYWxsQmFjayA9IHsgTG9ja2VkUmVzdWx0IGxvY2tlZFJlc3VsdCAtPg0KICAgICAgbG9ja2VkUmVzdWx0LnNldCgiRVhNWFBHIiwgdmFsKTsNCiAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYRFBHTiIsIGN0cik7DQogICAgICBsb2NrZWRSZXN1bHQuc2V0KCJFWENITk8iLCAoaW50KWxvY2tlZFJlc3VsdC5nZXQoIkVYQ0hOTyIpICsgMSk7DQogICAgICBsb2NrZWRSZXN1bHQuc2V0KCJFWExNRFQiLCBMb2NhbERhdGUubm93KCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigieXl5eU1NZGQiKSkudG9JbnRlZ2VyKCkpOw0KICAgICAgbG9ja2VkUmVzdWx0LnNldCgiRVhDSElEIiwgcHJvZ3JhbS5nZXRVc2VyKCkpOw0KICAgICAgDQogICAgICBsb2NrZWRSZXN1bHQudXBkYXRlKCk7DQogICAgICBjdHIrKzsNCiAgICB9Ow0KICAgIA0KICAgIHF1ZXJ5LnJlYWRBbGxMb2NrKGNvbnRhaW5lciwgNCwgdXBkYXRlQ2FsbEJhY2spOw0KICB9DQogIA0KICAvKioNCiAgICogUHJvY2VzcyBzb3J0ZWQgZGF0YSBmcm9tIEVYVDQzNiBhbmQgY29tcHV0ZSBwYWdlIG51bWJlcg0KICAgKiBAcGFyYW1zIENPTk8gLSBJbnB1dCBjb21wYW55DQogICAqIEBwYXJhbXMgQ09OTiAtIElucHV0IHNoaXBtZW50IG51bWJlcg0KICAgKiBAcGFyYW1zIHJvd1NpemUgLSBJbnB1dCByb3cgc2l6ZQ0KICAgKiBAcmV0dXJuIG5vdGhpbmcNCiAgKi8NCiAgdm9pZCBwcm9jZXNzU29ydGVkRGF0YUFsbChpbnQgQ09OTywgaW50IENPTk4sIGludCByb3dTaXplKSB7DQogICAgREJBY3Rpb24gc29ydGVkUXVlcnkgPSBkYXRhYmFzZS50YWJsZSgiRVhUNDM2IikuaW5kZXgoIjAwIikuc2VsZWN0QWxsRmllbGRzKCkuYnVpbGQoKTsNCiAgICBEQkNvbnRhaW5lciBzb3J0ZWRDb250YWluZXIgPSBzb3J0ZWRRdWVyeS5jcmVhdGVDb250YWluZXIoKTsNCiAgICBzb3J0ZWRDb250YWluZXIuc2V0KCJFWENPTk8iLCBDT05PKTsNCiAgICBzb3J0ZWRDb250YWluZXIuc2V0KCJFWENPTk4iLCBDT05OKTsNCiAgICANCiAgICBBcnJheUxpc3Q8TWFwPFN0cmluZywgU3RyaW5nPj4gbGluZXMgPSBuZXcgQXJyYXlMaXN0PE1hcDxTdHJpbmcsIFN0cmluZz4+KCk7DQogICAgaW50IGN0ciA9IDE7DQogICAgaW50IHBhZ2VOdW0gPSAxOw0KICAgIA0KICAgIFN0cmluZyBjdXJyQ09OQSA9IG51bGw7DQogICAgaW50IGN1cnJUeXBlID0gLTE7DQogICAgU3RyaW5nIGN1cnJDT0FGID0gbnVsbDsNCiAgICANCiAgICBEQkFjdGlvbiBsaW5lUXVlcnkgPSBkYXRhYmFzZS50YWJsZSgiRVhUNDM1IikuaW5kZXgoIjAwIikuYnVpbGQoKTsNCiAgICBEQkNvbnRhaW5lciBsaW5lQ29udGFpbmVyID0gbGluZVF1ZXJ5LmNyZWF0ZUNvbnRhaW5lcigpOw0KICAgIGxpbmVDb250YWluZXIuc2V0KCJFWENPTk8iLCBDT05PKTsNCiAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhDT05OIiwgQ09OTik7DQogICAgDQogICAgREJBY3Rpb24gaGVhZFF1ZXJ5ID0gZGF0YWJhc2UudGFibGUoIkVYVDQzNCIpLmluZGV4KCIwMCIpLmJ1aWxkKCk7DQogICAgREJDb250YWluZXIgaGVhZENvbnRhaW5lciA9IGhlYWRRdWVyeS5nZXRDb250YWluZXIoKTsNCiAgICBoZWFkQ29udGFpbmVyLnNldCgiRVhDT05PIiwgQ09OTyk7DQogICAgaGVhZENvbnRhaW5lci5zZXQoIkVYQ09OTiIsIENPTk4pOw0KICAgICAgDQogICAgc29ydGVkUXVlcnkucmVhZEFsbChzb3J0ZWRDb250YWluZXIsIDIsIE1BWF9SRUNPUkRTLCB7IERCQ29udGFpbmVyIHNvcnRlZERhdGEgLT4NCiAgICAgIFN0cmluZyBDT05BID0gc29ydGVkRGF0YS5nZXQoIkVYQ09OQSIpOw0KICAgICAgaW50IFRZUEUgPSBzb3J0ZWREYXRhLmdldCgiRVhUWVBFIik7DQogICAgICBTdHJpbmcgQ09BRiA9IHNvcnRlZERhdGEuZ2V0KCJFWENPQUYiKTsNCiAgICAgIA0KICAgICAgaWYoY3VyckNPTkEgPT0gbnVsbCAmJiBjdXJyVHlwZSA9PSAtMSAmJiBjdXJyQ09BRiA9PSBudWxsKSB7DQogICAgICAgIGN1cnJDT05BID0gQ09OQTsNCiAgICAgICAgY3VyclR5cGUgPSBUWVBFOw0KICAgICAgICBjdXJyQ09BRiA9IENPQUY7DQogICAgICB9DQogICAgICANCiAgICAgIGlmKCFjdXJyQ09OQS5lcXVhbHMoQ09OQSkgfHwgKGN1cnJDT05BLmVxdWFscyhDT05BKSAmJiBjdXJyVHlwZSAhPSBUWVBFKSB8fCAoY3VyckNPTkEuZXF1YWxzKENPTkEpICYmICFjdXJyQ09BRi5lcXVhbHMoQ09BRikpKSB7DQogICAgICAgIGN0ciA9IDE7DQogICAgICAgIHBhZ2VOdW0gPSAxOw0KICAgICAgICBjdXJyQ09OQSA9IENPTkE7DQogICAgICAgIGN1cnJUeXBlID0gVFlQRTsNCiAgICAgICAgY3VyckNPQUYgPSBDT0FGOw0KICAgICAgfQ0KICAgICAgDQogICAgICBpZihjdHIgPiByb3dTaXplKSB7DQogICAgICAgIGN0ciA9IDE7DQogICAgICAgIHBhZ2VOdW0rKzsNCiAgICAgIH0NCiAgICAgIA0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYT1JOTyIsIHNvcnRlZERhdGEuZ2V0KCJFWE9STk8iKSk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhQT05SIiwgc29ydGVkRGF0YS5nZXQoIkVYUE9OUiIpKTsNCiAgICAgIGxpbmVDb250YWluZXIuc2V0KCJFWERMSVgiLCBzb3J0ZWREYXRhLmdldCgiRVhETElYIikpOw0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYQ09OQSIsIHNvcnRlZERhdGEuZ2V0KCJFWENPTkEiKSk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhJVE5PIiwgc29ydGVkRGF0YS5nZXQoIkVYSVROTyIpIGFzIFN0cmluZyk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhJVE4yIiwgc29ydGVkRGF0YS5nZXQoIkVYSVROMiIpIGFzIFN0cmluZyk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhDRkk0Iiwgc29ydGVkRGF0YS5nZXQoIkVYQ0ZJNCIpKTsNCiAgICAgIGxpbmVDb250YWluZXIuc2V0KCJFWFRZUEUiLCBzb3J0ZWREYXRhLmdldCgiRVhUWVBFIikpOw0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYQ09MUiIsIHNvcnRlZERhdGEuZ2V0KCJFWENPTFIiKSk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhTSVpFIiwgc29ydGVkRGF0YS5nZXQoIkVYU0laRSIpKTsNCiAgICAgIGxpbmVDb250YWluZXIuc2V0KCJFWFBBR0UiLCBwYWdlTnVtKTsNCiAgICAgIGxpbmVDb250YWluZXIuc2V0KCJFWENPQUYiLCBzb3J0ZWREYXRhLmdldCgiRVhDT0FGIikpOw0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYU0FQUiIsIHNvcnRlZERhdGEuZ2V0KCJFWFNBUFIiKSk7DQogICAgICANCiAgICAgIGxpbmVDb250YWluZXIuc2V0KCJFWFJHRFQiLCBMb2NhbERhdGUubm93KCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigieXl5eU1NZGQiKSkudG9JbnRlZ2VyKCkpOw0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYUkdUTSIsIExvY2FsVGltZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJISG1tc3MiKSkudG9JbnRlZ2VyKCkpOw0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYTE1EVCIsIExvY2FsRGF0ZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJ5eXl5TU1kZCIpKS50b0ludGVnZXIoKSk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhDSE5PIiwgMCk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhDSElEIiwgcHJvZ3JhbS5nZXRVc2VyKCkpOw0KICAgICAgDQogICAgICBoZWFkQ29udGFpbmVyLnNldCgiRVhDT05BIiwgc29ydGVkRGF0YS5nZXQoIkVYQ09OQSIpKTsNCiAgICAgIGhlYWRDb250YWluZXIuc2V0KCJFWFRZUEUiLCBzb3J0ZWREYXRhLmdldCgiRVhUWVBFIikpOw0KICAgICAgaGVhZENvbnRhaW5lci5zZXQoIkVYUEFHRSIsIHBhZ2VOdW0pOw0KICAgICAgaGVhZENvbnRhaW5lci5zZXQoIkVYQ09BRiIsIHNvcnRlZERhdGEuZ2V0KCJFWENPQUYiKSk7DQogICAgICANCiAgICAgIGhlYWRDb250YWluZXIuc2V0KCJFWFJHRFQiLCBMb2NhbERhdGUubm93KCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigieXl5eU1NZGQiKSkudG9JbnRlZ2VyKCkpOw0KICAgICAgaGVhZENvbnRhaW5lci5zZXQoIkVYUkdUTSIsIExvY2FsVGltZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJISG1tc3MiKSkudG9JbnRlZ2VyKCkpOw0KICAgICAgaGVhZENvbnRhaW5lci5zZXQoIkVYTE1EVCIsIExvY2FsRGF0ZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJ5eXl5TU1kZCIpKS50b0ludGVnZXIoKSk7DQogICAgICBoZWFkQ29udGFpbmVyLnNldCgiRVhDSE5PIiwgMCk7DQogICAgICBoZWFkQ29udGFpbmVyLnNldCgiRVhDSElEIiwgcHJvZ3JhbS5nZXRVc2VyKCkpOw0KICAgICAgDQogICAgICBpZighaGVhZFF1ZXJ5LnJlYWQoaGVhZENvbnRhaW5lcikpew0KICAgICAgICBoZWFkUXVlcnkuaW5zZXJ0KGhlYWRDb250YWluZXIpOw0KICAgICAgfSAgDQoNCiAgICAgIGlmKGxpbmVRdWVyeS5yZWFkKGxpbmVDb250YWluZXIpKXsNCiAgICAgICAgbGluZVF1ZXJ5Lmluc2VydChsaW5lQ29udGFpbmVyKTsNCg0KICAgICAgfSANCiAgICAgIA0KICAgICAgY3RyKys7DQogICAgfSk7DQogIH0NCiAgDQogIC8qKg0KICAgKiBQcm9jZXNzIHNvcnRlZCBkYXRhIGZyb20gRVhUNDM2IGFuZCBjb21wdXRlIHBhZ2UgbnVtYmVyDQogICAqIEBwYXJhbXMgQ09OTyAtIElucHV0IGNvbXBhbnkNCiAgICogQHBhcmFtcyBDT05OIC0gSW5wdXQgc2hpcG1lbnQgbnVtYmVyDQogICAqIEBwYXJhbXMgcm93U2l6ZSAtIElucHV0IHJvdyBzaXplDQogICAqIEByZXR1cm4gbm90aGluZw0KICAqLw0KICB2b2lkIHByb2Nlc3NTb3J0ZWREYXRhU2luZ2xlKGludCBDT05PLCBsb25nIERMSVgsIGludCByb3dTaXplKSB7DQogICAgREJBY3Rpb24gc29ydGVkUXVlcnkgPSBkYXRhYmFzZS50YWJsZSgiRVhURDM2IikuaW5kZXgoIjAwIikuc2VsZWN0QWxsRmllbGRzKCkuYnVpbGQoKTsNCiAgICBEQkNvbnRhaW5lciBzb3J0ZWRDb250YWluZXIgPSBzb3J0ZWRRdWVyeS5jcmVhdGVDb250YWluZXIoKTsNCiAgICBzb3J0ZWRDb250YWluZXIuc2V0KCJFWENPTk8iLCBDT05PKTsNCiAgICBzb3J0ZWRDb250YWluZXIuc2V0KCJFWERMSVgiLCBETElYKTsNCiAgICANCiAgICBBcnJheUxpc3Q8TWFwPFN0cmluZywgU3RyaW5nPj4gbGluZXMgPSBuZXcgQXJyYXlMaXN0PE1hcDxTdHJpbmcsIFN0cmluZz4+KCk7DQogICAgaW50IGN0ciA9IDE7DQogICAgaW50IHBhZ2VOdW0gPSAxOw0KICAgIA0KICAgIFN0cmluZyBjdXJyQ09OQSA9IG51bGw7DQogICAgaW50IGN1cnJUeXBlID0gLTE7DQogICAgU3RyaW5nIGN1cnJDT0FGID0gbnVsbDsNCiAgICANCiAgICBEQkFjdGlvbiBsaW5lUXVlcnkgPSBkYXRhYmFzZS50YWJsZSgiRVhURDM1IikuaW5kZXgoIjAwIikuYnVpbGQoKTsNCiAgICBEQkNvbnRhaW5lciBsaW5lQ29udGFpbmVyID0gbGluZVF1ZXJ5LmNyZWF0ZUNvbnRhaW5lcigpOw0KICAgIGxpbmVDb250YWluZXIuc2V0KCJFWENPTk8iLCBDT05PKTsNCiAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhETElYIiwgRExJWCk7DQogICAgDQogICAgREJBY3Rpb24gaGVhZFF1ZXJ5ID0gZGF0YWJhc2UudGFibGUoIkVYVEQzNCIpLmluZGV4KCIwMCIpLmJ1aWxkKCk7DQogICAgREJDb250YWluZXIgaGVhZENvbnRhaW5lciA9IGhlYWRRdWVyeS5nZXRDb250YWluZXIoKTsNCiAgICBoZWFkQ29udGFpbmVyLnNldCgiRVhDT05PIiwgQ09OTyk7DQogICAgaGVhZENvbnRhaW5lci5zZXQoIkVYRExJWCIsIERMSVgpOw0KICAgICAgDQogICAgc29ydGVkUXVlcnkucmVhZEFsbChzb3J0ZWRDb250YWluZXIsIDIsIE1BWF9SRUNPUkRTLCB7IERCQ29udGFpbmVyIHNvcnRlZERhdGEgLT4NCiAgICAgIFN0cmluZyBDT05BID0gc29ydGVkRGF0YS5nZXQoIkVYQ09OQSIpOw0KICAgICAgaW50IFRZUEUgPSBzb3J0ZWREYXRhLmdldCgiRVhUWVBFIik7DQogICAgICBTdHJpbmcgQ09BRiA9IHNvcnRlZERhdGEuZ2V0KCJFWENPQUYiKTsNCiAgICAgIA0KICAgICAgaWYoY3VyckNPTkEgPT0gbnVsbCAmJiBjdXJyVHlwZSA9PSAtMSAmJiBjdXJyQ09BRiA9PSBudWxsKSB7DQogICAgICAgIGN1cnJDT05BID0gQ09OQTsNCiAgICAgICAgY3VyclR5cGUgPSBUWVBFOw0KICAgICAgICBjdXJyQ09BRiA9IENPQUY7DQogICAgICB9DQogICAgICANCiAgICAgIGlmKCFjdXJyQ09OQS5lcXVhbHMoQ09OQSkgfHwgKGN1cnJDT05BLmVxdWFscyhDT05BKSAmJiBjdXJyVHlwZSAhPSBUWVBFKSB8fCAoY3VyckNPTkEuZXF1YWxzKENPTkEpICYmICFjdXJyQ09BRi5lcXVhbHMoQ09BRikpKSB7DQogICAgICAgIGN0ciA9IDE7DQogICAgICAgIHBhZ2VOdW0gPSAxOw0KICAgICAgICBjdXJyQ09OQSA9IENPTkE7DQogICAgICAgIGN1cnJUeXBlID0gVFlQRTsNCiAgICAgICAgY3VyckNPQUYgPSBDT0FGOw0KICAgICAgfQ0KICAgICAgDQogICAgICBpZihjdHIgPiByb3dTaXplKSB7DQogICAgICAgIGN0ciA9IDE7DQogICAgICAgIHBhZ2VOdW0rKzsNCiAgICAgIH0NCiAgICAgIA0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYT1JOTyIsIHNvcnRlZERhdGEuZ2V0KCJFWE9STk8iKSk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhQT05SIiwgc29ydGVkRGF0YS5nZXQoIkVYUE9OUiIpKTsNCiAgICAgIGxpbmVDb250YWluZXIuc2V0KCJFWERMSVgiLCBzb3J0ZWREYXRhLmdldCgiRVhETElYIikpOw0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYQ09OQSIsIHNvcnRlZERhdGEuZ2V0KCJFWENPTkEiKSk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhJVE5PIiwgc29ydGVkRGF0YS5nZXQoIkVYSVROTyIpIGFzIFN0cmluZyk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhJVE4yIiwgc29ydGVkRGF0YS5nZXQoIkVYSVROMiIpIGFzIFN0cmluZyk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhDRkk0Iiwgc29ydGVkRGF0YS5nZXQoIkVYQ0ZJNCIpKTsNCiAgICAgIGxpbmVDb250YWluZXIuc2V0KCJFWFRZUEUiLCBzb3J0ZWREYXRhLmdldCgiRVhUWVBFIikpOw0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYQ09MUiIsIHNvcnRlZERhdGEuZ2V0KCJFWENPTFIiKSk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhTSVpFIiwgc29ydGVkRGF0YS5nZXQoIkVYU0laRSIpKTsNCiAgICAgIGxpbmVDb250YWluZXIuc2V0KCJFWFBBR0UiLCBwYWdlTnVtKTsNCiAgICAgIGxpbmVDb250YWluZXIuc2V0KCJFWENPQUYiLCBzb3J0ZWREYXRhLmdldCgiRVhDT0FGIikpOw0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYU0FQUiIsIHNvcnRlZERhdGEuZ2V0KCJFWFNBUFIiKSk7DQogICAgICANCiAgICAgIGxpbmVDb250YWluZXIuc2V0KCJFWFJHRFQiLCBMb2NhbERhdGUubm93KCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigieXl5eU1NZGQiKSkudG9JbnRlZ2VyKCkpOw0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYUkdUTSIsIExvY2FsVGltZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJISG1tc3MiKSkudG9JbnRlZ2VyKCkpOw0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYTE1EVCIsIExvY2FsRGF0ZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJ5eXl5TU1kZCIpKS50b0ludGVnZXIoKSk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhDSE5PIiwgMCk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhDSElEIiwgcHJvZ3JhbS5nZXRVc2VyKCkpOw0KICAgICAgDQogICAgICBoZWFkQ29udGFpbmVyLnNldCgiRVhDT05BIiwgc29ydGVkRGF0YS5nZXQoIkVYQ09OQSIpKTsNCiAgICAgIGhlYWRDb250YWluZXIuc2V0KCJFWFRZUEUiLCBzb3J0ZWREYXRhLmdldCgiRVhUWVBFIikpOw0KICAgICAgaGVhZENvbnRhaW5lci5zZXQoIkVYUEFHRSIsIHBhZ2VOdW0pOw0KICAgICAgaGVhZENvbnRhaW5lci5zZXQoIkVYQ09BRiIsIHNvcnRlZERhdGEuZ2V0KCJFWENPQUYiKSk7DQogICAgICANCiAgICAgIGhlYWRDb250YWluZXIuc2V0KCJFWFJHRFQiLCBMb2NhbERhdGUubm93KCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigieXl5eU1NZGQiKSkudG9JbnRlZ2VyKCkpOw0KICAgICAgaGVhZENvbnRhaW5lci5zZXQoIkVYUkdUTSIsIExvY2FsVGltZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJISG1tc3MiKSkudG9JbnRlZ2VyKCkpOw0KICAgICAgaGVhZENvbnRhaW5lci5zZXQoIkVYTE1EVCIsIExvY2FsRGF0ZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJ5eXl5TU1kZCIpKS50b0ludGVnZXIoKSk7DQogICAgICBoZWFkQ29udGFpbmVyLnNldCgiRVhDSE5PIiwgMCk7DQogICAgICBoZWFkQ29udGFpbmVyLnNldCgiRVhDSElEIiwgcHJvZ3JhbS5nZXRVc2VyKCkpOw0KICAgICAgDQogICAgICBpZighaGVhZFF1ZXJ5LnJlYWQoaGVhZENvbnRhaW5lcikpew0KICAgICAgICBoZWFkUXVlcnkuaW5zZXJ0KGhlYWRDb250YWluZXIpOw0KICAgICAgfQ0KICAgICAgDQogICAgICBpZighbGluZVF1ZXJ5LnJlYWQobGluZUNvbnRhaW5lcikpew0KICAgICAgICBsaW5lUXVlcnkuaW5zZXJ0KGxpbmVDb250YWluZXIpOw0KICAgICAgfQ0KICAgICAgDQogICAgICBjdHIrKzsNCiAgICB9KTsNCiAgfQ0KICANCiAgLyoqDQogICAqIEluc2VydCBkYXRhIHRvIHRoZSBFWFQ0MzYgdGFibGUNCiAgICogQHBhcmFtcyBDT05PIC0gSW5wdXQgY29tcGFueQ0KICAgKiBAcGFyYW1zIENPTk4gLSBJbnB1dCBzaGlwbWVudCBudW1iZXINCiAgICogQHBhcmFtcyBsaW5lcyAtIGNvbnRhaW5pbmcgdGhlIGxpbmVzIHRvIGJlIGluc2VydGVkDQogICAqIEByZXR1cm4gbm90aGluZw0KICAqLw0KICB2b2lkIGluc2VydERhdGFUb0VYVDQzNihpbnQgQ09OTywgaW50IENPTk4sIEFycmF5TGlzdDxNYXA8U3RyaW5nLCBTdHJpbmc+PiBsaW5lcykgew0KICAgIERCQWN0aW9uIGxpbmVRdWVyeSA9IGRhdGFiYXNlLnRhYmxlKCJFWFQ0MzYiKS5pbmRleCgiMDAiKS5idWlsZCgpOw0KICAgIERCQ29udGFpbmVyIGxpbmVDb250YWluZXIgPSBsaW5lUXVlcnkuZ2V0Q29udGFpbmVyKCk7DQogICAgbGluZUNvbnRhaW5lci5zZXQoIkVYQ09OTyIsIENPTk8pOw0KICAgIGxpbmVDb250YWluZXIuc2V0KCJFWENPTk4iLCBDT05OKTsNCiAgICANCiAgICBmb3IgKGludCBpPTA7IGk8bGluZXMuc2l6ZSgpOyBpKyspIHsNCiAgICAgIE1hcDxTdHJpbmcsIFN0cmluZz4gcmVjb3JkID0gKE1hcDxTdHJpbmcsIFN0cmluZz4pIGxpbmVzW2ldOw0KICAgICAgDQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhETElYIiwgcmVjb3JkLkRMSVggYXMgbG9uZyk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhDT05BIiwgcmVjb3JkLkNPTkEpOw0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYT1JOTyIsIHJlY29yZC5PUk5PKTsNCiAgICAgIGxpbmVDb250YWluZXIuc2V0KCJFWFBPTlIiLCByZWNvcmQuUE9OUiBhcyBpbnQpOw0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYSVROTyIsIHJlY29yZC5JVE5PIGFzIFN0cmluZyk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhJVE4yIiwgcmVjb3JkLklUTjIgYXMgU3RyaW5nKTsNCiAgICAgIGxpbmVDb250YWluZXIuc2V0KCJFWENGSTQiLCByZWNvcmQuQ0ZJNCk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhUWVBFIiwgcmVjb3JkLlRZUEUgYXMgaW50KTsNCiAgICAgIGxpbmVDb250YWluZXIuc2V0KCJFWENPTFIiLCByZWNvcmQuQ09MUik7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhTSVpFIiwgcmVjb3JkLlNJWkUpOw0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYQ09BRiIsIHJlY29yZC5DT0FGKTsNCiAgICAgIGxpbmVDb250YWluZXIuc2V0KCJFWFNBUFIiLCByZWNvcmQuU0FQUiBhcyBkb3VibGUpOw0KICAgICAgDQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhSR0RUIiwgTG9jYWxEYXRlLm5vdygpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oInl5eXlNTWRkIikpLnRvSW50ZWdlcigpKTsNCiAgICAgIGxpbmVDb250YWluZXIuc2V0KCJFWFJHVE0iLCBMb2NhbFRpbWUubm93KCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigiSEhtbXNzIikpLnRvSW50ZWdlcigpKTsNCiAgICAgIGxpbmVDb250YWluZXIuc2V0KCJFWExNRFQiLCBMb2NhbERhdGUubm93KCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigieXl5eU1NZGQiKSkudG9JbnRlZ2VyKCkpOw0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYQ0hOTyIsIDApOw0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYQ0hJRCIsIHByb2dyYW0uZ2V0VXNlcigpKTsNCiAgICAgIA0KICAgICAgaWYoIWxpbmVRdWVyeS5yZWFkKGxpbmVDb250YWluZXIpKXsNCiAgICAgICAgbGluZVF1ZXJ5Lmluc2VydChsaW5lQ29udGFpbmVyKTsNCiAgICAgIH0NCiAgICB9DQogIH0NCiAgDQogIC8qKg0KICAgKiBJbnNlcnQgZGF0YSB0byB0aGUgRVhUNDM2IHRhYmxlDQogICAqIEBwYXJhbXMgQ09OTyAtIElucHV0IGNvbXBhbnkNCiAgICogQHBhcmFtcyBDT05OIC0gSW5wdXQgc2hpcG1lbnQgbnVtYmVyDQogICAqIEBwYXJhbXMgbGluZXMgLSBjb250YWluaW5nIHRoZSBsaW5lcyB0byBiZSBpbnNlcnRlZA0KICAgKiBAcmV0dXJuIG5vdGhpbmcNCiAgKi8NCiAgdm9pZCBpbnNlcnREYXRhVG9FWFREMzYoaW50IENPTk8sIGxvbmcgRExJWCwgQXJyYXlMaXN0PE1hcDxTdHJpbmcsIFN0cmluZz4+IGxpbmVzKSB7DQogICAgREJBY3Rpb24gbGluZVF1ZXJ5ID0gZGF0YWJhc2UudGFibGUoIkVYVEQzNiIpLmluZGV4KCIwMCIpLmJ1aWxkKCk7DQogICAgREJDb250YWluZXIgbGluZUNvbnRhaW5lciA9IGxpbmVRdWVyeS5nZXRDb250YWluZXIoKTsNCiAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhDT05PIiwgQ09OTyk7DQogICAgbGluZUNvbnRhaW5lci5zZXQoIkVYRExJWCIsIERMSVgpOw0KICAgIA0KICAgIGZvciAoaW50IGk9MDsgaTxsaW5lcy5zaXplKCk7IGkrKykgew0KICAgICAgTWFwPFN0cmluZywgU3RyaW5nPiByZWNvcmQgPSAoTWFwPFN0cmluZywgU3RyaW5nPikgbGluZXNbaV07DQogICAgICANCiAgICAgIGxpbmVDb250YWluZXIuc2V0KCJFWENPTkEiLCByZWNvcmQuQ09OQSk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhPUk5PIiwgcmVjb3JkLk9STk8pOw0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYUE9OUiIsIHJlY29yZC5QT05SIGFzIGludCk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhJVE5PIiwgcmVjb3JkLklUTk8gYXMgU3RyaW5nKTsNCiAgICAgIGxpbmVDb250YWluZXIuc2V0KCJFWElUTjIiLCByZWNvcmQuSVROMiBhcyBTdHJpbmcpOw0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYQ0ZJNCIsIHJlY29yZC5DRkk0KTsNCiAgICAgIGxpbmVDb250YWluZXIuc2V0KCJFWFRZUEUiLCByZWNvcmQuVFlQRSBhcyBpbnQpOw0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYQ09MUiIsIHJlY29yZC5DT0xSKTsNCiAgICAgIGxpbmVDb250YWluZXIuc2V0KCJFWFNJWkUiLCByZWNvcmQuU0laRSk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhDT0FGIiwgcmVjb3JkLkNPQUYpOw0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYU0FQUiIsIHJlY29yZC5TQVBSIGFzIGRvdWJsZSk7DQogICAgICANCiAgICAgIGxpbmVDb250YWluZXIuc2V0KCJFWFJHRFQiLCBMb2NhbERhdGUubm93KCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigieXl5eU1NZGQiKSkudG9JbnRlZ2VyKCkpOw0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYUkdUTSIsIExvY2FsVGltZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJISG1tc3MiKSkudG9JbnRlZ2VyKCkpOw0KICAgICAgbGluZUNvbnRhaW5lci5zZXQoIkVYTE1EVCIsIExvY2FsRGF0ZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJ5eXl5TU1kZCIpKS50b0ludGVnZXIoKSk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhDSE5PIiwgMCk7DQogICAgICBsaW5lQ29udGFpbmVyLnNldCgiRVhDSElEIiwgcHJvZ3JhbS5nZXRVc2VyKCkpOw0KICAgICAgDQogICAgICBpZighbGluZVF1ZXJ5LnJlYWQobGluZUNvbnRhaW5lcikpew0KICAgICAgICBsaW5lUXVlcnkuaW5zZXJ0KGxpbmVDb250YWluZXIpOw0KICAgICAgfQ0KICAgIH0NCiAgfQ0KICANCiAgDQogIC8qKg0KICAgKiBHZXQgTU1DRkk0IC0gQmxvY2sgbnVtYmVyIGZyb20gTUlUTUFTDQogICAqIEBwYXJhbXMgQ09OTyAtIElucHV0IGNvbXBhbnkNCiAgICogQHBhcmFtcyBJVE5PIC0gSW5wdXQgaXRlbSBudW1iZXINCiAgICogQHJldHVybiBibG9jaw0KICAqLw0KICBTdHJpbmcgZ2V0QmxvY2soaW50IENPTk8sIFN0cmluZyBJVE5PKSB7DQogICAgREJBY3Rpb24gcXVlcnkgPSBkYXRhYmFzZS50YWJsZSgiTUlUTUFTIikuaW5kZXgoIjAwIikuc2VsZWN0aW9uKCJNTUNGSTQiKS5idWlsZCgpOw0KICAgIERCQ29udGFpbmVyIGNvbnRhaW5lciA9IHF1ZXJ5LmNyZWF0ZUNvbnRhaW5lcigpOw0KICAgIGNvbnRhaW5lci5zZXQoIk1NQ09OTyIsIENPTk8pOw0KICAgIGNvbnRhaW5lci5zZXQoIk1NSVROTyIsIElUTk8pOw0KICAgIA0KICAgIFN0cmluZyBibG9jayA9ICIiOw0KICAgIA0KICAgIGlmIChxdWVyeS5yZWFkKGNvbnRhaW5lcikpIHsNCiAgICAgIGJsb2NrID0gY29udGFpbmVyLmdldCgiTU1DRkk0Iik7DQogICAgfQ0KICAgIA0KICAgIHJldHVybiBibG9jazsNCiAgfQ0KICANCiAgDQogIC8qKg0KICAgKiBEZWxldGUgYWxsIHJlY29yZHMgZGVwZW5kaW5nIG9uIENPTk4NCiAgICogQHBhcmFtcyBDT05PIC0gSW5wdXQgY29tcGFueQ0KICAgKiBAcGFyYW1zIENPTk4gLSBJbnB1dCBzaGlwbWVudCBudW1iZXINCiAgICogQHBhcmFtcyB0YWJsZSAtIElucHV0IFh0ZW5kIFRhYmxlDQogICAqIEByZXR1cm4gbm90aGluZw0KICAqLw0KICB2b2lkIGRlbGV0ZVJlY29yZHNCeUNPTk4oaW50IENPTk8sIGludCBDT05OLCBTdHJpbmcgdGFibGUpIHsNCiAgICBEQkFjdGlvbiBxdWVyeSA9IGRhdGFiYXNlLnRhYmxlKHRhYmxlKS5pbmRleCgiMDAiKS5idWlsZCgpOw0KICAgIERCQ29udGFpbmVyIGNvbnRhaW5lciA9IHF1ZXJ5LmNyZWF0ZUNvbnRhaW5lcigpOw0KICAgIGNvbnRhaW5lci5zZXQoIkVYQ09OTyIsIENPTk8pOw0KICAgIGNvbnRhaW5lci5zZXQoIkVYQ09OTiIsIENPTk4pOw0KICAgIA0KICAgIENsb3N1cmU8Pz4gZGVsZXRlUmVjb3JkcyA9IHtMb2NrZWRSZXN1bHQgcmVzdWx0IC0+DQogICAgICByZXN1bHQuZGVsZXRlKCk7DQogICAgfQ0KICAgIA0KICAgIHF1ZXJ5LnJlYWRBbGxMb2NrKGNvbnRhaW5lciwgMiwgZGVsZXRlUmVjb3Jkcyk7DQogIH0NCiAgDQogIC8qKg0KICAgKiBEZWxldGUgYWxsIHJlY29yZHMgZGVwZW5kaW5nIG9uIERMSVgNCiAgICogQHBhcmFtcyBDT05PIC0gSW5wdXQgY29tcGFueQ0KICAgKiBAcGFyYW1zIERMSVggLSBJbnB1dCBkZWxpdmVyeSBudW1iZXINCiAgICogQHBhcmFtcyB0YWJsZSAtIElucHV0IFh0ZW5kIFRhYmxlDQogICAqIEByZXR1cm4gbm90aGluZw0KICAqLw0KICB2b2lkIGRlbGV0ZVJlY29yZHNCeURMSVgoaW50IENPTk8sIGxvbmcgRExJWCwgU3RyaW5nIHRhYmxlKSB7DQogICAgREJBY3Rpb24gcXVlcnkgPSBkYXRhYmFzZS50YWJsZSh0YWJsZSkuaW5kZXgoIjAwIikuYnVpbGQoKTsNCiAgICBEQkNvbnRhaW5lciBjb250YWluZXIgPSBxdWVyeS5jcmVhdGVDb250YWluZXIoKTsNCiAgICBjb250YWluZXIuc2V0KCJFWENPTk8iLCBDT05PKTsNCiAgICBjb250YWluZXIuc2V0KCJFWERMSVgiLCBETElYIGFzIGxvbmcpOw0KICAgIA0KICAgIENsb3N1cmU8Pz4gZGVsZXRlUmVjb3JkcyA9IHtMb2NrZWRSZXN1bHQgcmVzdWx0IC0+DQogICAgICByZXN1bHQuZGVsZXRlKCk7DQogICAgfQ0KICAgIA0KICAgIHF1ZXJ5LnJlYWRBbGxMb2NrKGNvbnRhaW5lciwgMiwgZGVsZXRlUmVjb3Jkcyk7DQogIH0NCiAgDQp9"}}}